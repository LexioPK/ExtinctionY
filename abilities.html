<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Abilities - Extinction Y</title>

<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600&display=swap" rel="stylesheet">

<!-- Standardized header styles & script -->
<link rel="stylesheet" href="header.css">
<script src="header.js" defer></script>

<style>
    body {
        font-family: "Lexend", sans-serif;
        background: #f0f0f0;
        margin: 0;
        padding: 20px;
    }

    h1 {
        text-align: center;
        margin-top: 10px;
        margin-bottom: 20px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        border-radius: 12px;
        overflow: hidden;
    }

    th, td {
        text-align: left;
        padding: 10px 12px;
        border-bottom: 1px solid #ddd;
        font-size: 0.9em;
    }

    th {
        background: #f5f5f5;
        font-weight: 600;
    }

    tr:hover { 
        background: #f0f0f0;
        cursor: pointer;
    }

    .ability-name {
        font-weight: 600;
        color: #333;
    }

    .ability-count {
        color: #666;
        font-size: 0.85em;
    }
</style>
</head>
<body>

<h1>Abilities</h1>

<table id="abilities-table">
    <thead>
        <tr>
            <th>Ability Name</th>
            <th>Description</th>
            <th>Pokémon Count</th>
        </tr>
    </thead>
    <tbody>
        <!-- Abilities will be populated here -->
    </tbody>
</table>

<script>
async function loadAbilities() {
    const tbody = document.querySelector("#abilities-table tbody");

    try {
        // Fetch both abilities and pokedex data
        const [abilitiesRes, pokedexRes] = await Promise.all([
            fetch("data/abilities.json"),
            fetch("data/pokedex.json")
        ]);

        const abilities = await abilitiesRes.json();
        const pokedex = await pokedexRes.json();

        // Count how many Pokémon have each ability
        const abilityCount = {};
        Object.values(pokedex).forEach(pokemon => {
            const pokemonAbilities = [pokemon.Ability1, pokemon.Ability2, pokemon.AbilityH].filter(Boolean);
            const uniqueAbilities = [...new Set(pokemonAbilities)];
            uniqueAbilities.forEach(ability => {
                if (!abilityCount[ability]) abilityCount[ability] = 0;
                abilityCount[ability]++;
            });
        });

        // Sort abilities alphabetically
        const sorted = Object.entries(abilities).sort((a, b) => {
            const nameA = a[1].name || a[0];
            const nameB = b[1].name || b[0];
            return nameA.localeCompare(nameB);
        });

        sorted.forEach(([key, ability]) => {
            const tr = document.createElement("tr");
            const abilityName = ability.name || key;
            const count = abilityCount[abilityName] || 0;

            tr.innerHTML = `
                <td><span class="ability-name">${abilityName}</span></td>
                <td>${ability.shortDesc || ability.desc || "No description available."}</td>
                <td><span class="ability-count">${count} Pokémon</span></td>
            `;

            tbody.appendChild(tr);
        });
    } catch (error) {
        console.error("Error loading abilities:", error);
        tbody.innerHTML = '<tr><td colspan="3">Error loading abilities data.</td></tr>';
    }
}

loadAbilities();
</script>

</body>
</html>