<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pokémon Info</title>

<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Lexend', sans-serif;
    margin: 0;
    background: #f5f5f5;
  }

  header {
    background:#222;
    color:white;
    padding:15px;
    text-align:center;
    font-size:24px;
  }

  .content {
    padding:20px;
    max-width:800px;
    margin:auto;
  }

  .sprite {
    width:128px;
    height:128px;
    display:block;
    margin:10px auto;
    image-rendering:pixelated;
  }

  .type-badge {
    display:inline-block;
    padding:4px 10px;
    margin-right:4px;
    border-radius:12px;
    color:white;
    font-weight:600;
    font-size:14px;
    margin-bottom:10px;
  }

  .card {
    background:white;
    padding:20px;
    border-radius:12px;
    box-shadow:0 2px 5px rgba(0,0,0,0.15);
  }

  h2, h3 {
    margin:5px 0;
    text-align:center;
  }

  ul {
    padding-left:20px;
  }

  a.back {
    color:#4285F4;
    font-size:16px;
    text-decoration:none;
  }

  .moves-list li {
    margin-bottom:4px;
  }
</style>
</head>
<body>

<header id="header">Pokémon Info</header>

<div class="content">
  <a class="back" href="index.html">← Back to Pokédex</a>
  <div id="pokemonCard" class="card" style="margin-top:20px;">Loading…</div>
</div>

<script>
const typeColors = {
  Normal: "#A8A77A",
  Fire: "#EE8130",
  Water: "#6390F0",
  Electric: "#F7D02C",
  Grass: "#7AC74C",
  Ice: "#96D9D6",
  Fighting: "#C22E28",
  Poison: "#A33EA1",
  Ground: "#E2BF65",
  Flying: "#A98FF3",
  Psychic: "#F95587",
  Bug: "#A6B91A",
  Rock: "#B6A136",
  Ghost: "#735797",
  Dragon: "#6F35FC",
  Dark: "#705746",
  Steel: "#B7B7CE",
  Fairy: "#D685AD"
};

const monName = new URL(window.location.href).searchParams.get("name");

Promise.all([
  fetch('data/pokedex.json').then(r => r.json()),
  fetch('data/movesets.json').then(r => r.json())
])
.then(([pokedexData, movesetsData]) => {
  const mon = pokedexData[monName];
  if (!mon) {
    document.getElementById("pokemonCard").textContent = "Pokémon not found.";
    return;
  }

  const types = [mon.Type1, mon.Type2].filter((t,i,a)=>t && a.indexOf(t)===i);
  const spriteName = monName.toLowerCase().replace(/\s+/g,'-');
  const imageUrl = `https://play.pokemonshowdown.com/sprites/gen5/${spriteName}.png`;
  const bst = mon.BST ??
    (mon.BaseStats.HP +
     mon.BaseStats.Atk +
     mon.BaseStats.Def +
     mon.BaseStats.SpA +
     mon.BaseStats.SpD +
     mon.BaseStats.Spe);

  const moves = movesetsData[monName] || [];

  document.getElementById("header").textContent = `#${String(mon.SpeciesIdx).padStart(3,'0')} ${monName}`;

  document.getElementById("pokemonCard").innerHTML = `
    <img class="sprite" src="${imageUrl}" onerror="this.src='https://play.pokemonshowdown.com/sprites/gen5/unknown.png'">

    <div style="text-align:center; margin-bottom:10px;">
      ${types.map(t=>`<span class="type-badge" style="background:${typeColors[t]}">${t}</span>`).join("")}
    </div>

    <h3>Abilities</h3>
    <ul>
      <li>${mon.Ability1}</li>
      <li>${mon.Ability2 ? mon.Ability2 : ""}</li>
      <li>Hidden: ${mon.AbilityH}</li>
    </ul>

    <h3>Base Stats</h3>
    <ul>
      <li>HP: ${mon.BaseStats.HP}</li>
      <li>Atk: ${mon.BaseStats.Atk}</li>
      <li>Def: ${mon.BaseStats.Def}</li>
      <li>SpA: ${mon.BaseStats.SpA}</li>
      <li>SpD: ${mon.BaseStats.SpD}</li>
      <li>Spe: ${mon.BaseStats.Spe}</li>
      <li><strong>Total: ${bst}</strong></li>
    </ul>

    ${mon.TMs ? `<h3>TMs</h3>
      <ul>${mon.TMs.map(tm=>`<li>${tm.Label}: ${tm.Move}</li>`).join("")}</ul>` : ""}

    ${moves.length ? `<h3>Level-up Moves</h3>
      <ul class="moves-list">
        ${moves.map(m=>`<li>Lvl ${m.Level}: ${m.Move}</li>`).join("")}
      </ul>` : ""}
  `;
})
.catch(err => console.error("Error loading data:", err));
</script>

</body>
</html>
